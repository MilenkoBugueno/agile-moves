.panel.panel-info
  .panel-heading
    %h3= @certification.label + ": " + @certification.title
  .panel-body
    .row
      .span7
        %p
          - if (current_user.has_role? :admin) || (current_user.id == @certification.user_id)
            = link_to t("helpers.links.edit"), edit_certification_path(@certification), :class => 'btn'
            -if @project.present?
              = link_to t("helpers.links.back"), certificate_projects_path(id: @project.id), :class => 'btn'
            -else
              = link_to t("helpers.links.back"), certifications_path, :class => 'btn'
        %br
        %p
          %strong=t("simple_form.labels.certification.description") + ": "
          %i
            =raw(@certification.description)
      .span4
        %p
          %strong=t("simple_form.labels.certification.user") + ": "
          ="#{@certification.user.name}" if @certification.user.present?
        %p
          %strong=t("simple_form.labels.certification.move_type") + ": "
          ="#{@certification.move_type.title}" if @certification.move_type.present?
        %p
          %strong=t("simple_form.labels.certification.moves_number") + ": "
          =@certification.moves_number if @certification.moves_number.present?
        %p
          %strong=t("simple_form.labels.certification.approvements") + ": "
          =@certification.approvements if @certification.approvements.present?


.panel.panel-default
  .panel-heading
    %h4= t("simple_form.labels.registrations")
  .panel-body
    %table.table.table-striped
      %thead
        %tr
          %th
          %th= t("simple_form.labels.registration.user_id")
          %th= t("simple_form.labels.registration.start_date")
          %th= t("simple_form.labels.registration.end_date")
          %th= t("simple_form.labels.registration.progress")
          %th=t '.actions', :default => t("helpers.actions")
      %tbody
        - @certification.registrations.each do |registration|
          %tr
            %td
            %td
              -if @project.present?
                = link_to registration.user.name, inscription_path(registration, project_id: @project.id)
              -else
                = link_to registration.user.name, inscription_path(registration)
            %td= registration.start_date.to_s(:short) if registration.start_date.present?
            %td= registration.end_date.to_s(:short) if registration.end_date.present?
            %td
              .progress
                .progress-bar.progress-bar-success{:role=>"progressbar", "aria-valuenow"=>"#{registration.moves.count}", "aria-valuemin"=>"0", "aria-valuemax"=>"#{@certification.moves_number}", "style"=>"width: #{get_progressbar_width(registration)}%;"}
                  =registration.moves.count
                %p{:style => 'float: right;'}
                  =@certification.moves_number if @certification.moves_number.present?
            %td
              = link_to t('.edit', :default => t("helpers.links.edit")), edit_inscription_path(registration), :class => 'btn btn-default btn-mini'
              = link_to t('.destroy', :default => t("helpers.links.destroy")), inscription_path(registration), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-mini btn-danger'

    -if !@certification.get_registration(current_user).present? || (current_user.has_role? :admin)
      = link_to t("helpers.links.registrate"), new_inscription_path(certification_id: @certification.id), :class => 'btn btn-primary'

